; Optimized OPcache Configuration for PHP 8.4 / GLPI 11
; For 8GB RAM / 6 CPU cores system

[opcache]

; Core settings
opcache.enable = 1
opcache.enable_cli = 0
opcache.memory_consumption = 256    ; 256MB for opcache (from default 128MB)
opcache.interned_strings_buffer = 16 ; 16MB for interned strings (from 8MB)
opcache.max_accelerated_files = 20000 ; Increased from default

; Performance settings
opcache.validate_timestamps = 0     ; Disable in production (faster)
opcache.revalidate_freq = 0         ; Don't check file timestamps

; For development, use:
; opcache.validate_timestamps = 1
; opcache.revalidate_freq = 60

; Advanced optimization
opcache.fast_shutdown = 1
opcache.enable_file_override = 1
opcache.huge_code_pages = 1         ; Use huge pages for code (5.4+)

; JIT compilation (PHP 8.0+) - Significant performance improvement
opcache.jit = tracing               ; Use tracing JIT (9x faster than function JIT)
opcache.jit_buffer_size = 100M      ; 100MB for JIT compilation
opcache.jit_bisect_limit = 0        ; Disable bisection (stability)

; Preloading (optional - list frequently used files)
; opcache.preload = /var/www/glpi/preload.php

; Error logging
opcache.log_verbosity_level = 1
opcache.error_log = /var/log/php8.4-opcache-errors.log
